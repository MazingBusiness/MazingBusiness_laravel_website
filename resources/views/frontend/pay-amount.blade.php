<html lang="en">
  <head>

    <meta name="csrf-token" content="tlMii0p0eORNEN9ioYFMTuO6sUhZmst1LQwCmh0D">
    <meta name="app-url" content="//mazingbusiness.com/">
    <meta name="file-base-url" content="https://mazingbusiness.com/public/">
    <meta name="facebook-domain-verification" content="k417v9v9jsneemmwemupdh8l0bl3g9">
    <title>Mazing Business | Online store for Businesses dealing in industrial tools and agricultural tools</title>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="index, follow">
    <meta name="description" content="Online store for Businesses dealing in industrial tools and agricultural tools">
    <meta name="keywords" content="">

    
    <!-- Schema.org markup for Google+ -->
    <meta itemprop="name" content="Mazing Business">
    <meta itemprop="description" content="Online store for Businesses dealing in industrial tools and agricultural tools">
    <meta itemprop="image" content="https://mazingbusiness.com/public/assets/img/placeholder.jpg">

    <!-- Twitter Card data -->
    <meta name="twitter:card" content="product">
    <meta name="twitter:site" content="@publisher_handle">
    <meta name="twitter:title" content="Mazing Business">
    <meta name="twitter:description" content="Online store for Businesses dealing in industrial tools and agricultural tools">
    <meta name="twitter:creator" content="@author_handle">
    <meta name="twitter:image" content="https://mazingbusiness.com/public/assets/img/placeholder.jpg">

    <!-- Open Graph data -->
    <meta property="og:title" content="Mazing Business">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://mazingbusiness.com">
    <meta property="og:image" content="https://mazingbusiness.com/public/assets/img/placeholder.jpg">
    <meta property="og:description" content="Online store for Businesses dealing in industrial tools and agricultural tools">
    <meta property="og:site_name" content="Mazing Business">
    <meta property="fb:app_id" content="">
      
    <!-- Favicon -->
    <link rel="icon" href="https://mazingbusiness.com/public/uploads/all/rDWmR9Rr7mzv3QQSFC1uLLMqn4Osi1wbAYqNPInv.png">
    <script async="" src="https://connect.facebook.net/en_US/fbevents.js"></script><script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
    <link href="https://fonts.googleapis.com/css2?family=Jost:ital,wght@0,300;0,400;0,600;0,700;0,800;1,300;1,400;1,600;1,700;1,800&amp;display=swap" rel="stylesheet">

    <!-- CSS Files -->
    <link rel="stylesheet" href="https://mazingbusiness.com/public/assets/css/vendors.css">
        <link rel="stylesheet" href="https://mazingbusiness.com/public/assets/css/aiz-core.css">
    <link rel="stylesheet" href="https://mazingbusiness.com/public/assets/css/custom-style.css">

    

    <!-- Select 2 dropdown Start -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.4/css/select2.min.css" rel="stylesheet">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.4/js/select2.min.js"></script>
    <style>
        /* body {
            font-family: 'Ubuntu', sans-serif;
            font-weight: bold;
        } */
        .select2-container {
            min-width: 400px;
        }

        .select2-results__option {
            padding-right: 20px;
            vertical-align: middle;
        }
        .select2-results__option:before {
            content: "";
            display: inline-block;
            position: relative;
            height: 20px;
            width: 20px;
            border: 2px solid #e9e9e9;
            border-radius: 4px;
            background-color: #fff;
            margin-right: 20px;
            vertical-align: middle;
        }
        .select2-results__option[aria-selected=true]:before {
            font-family:fontAwesome;
            content: "\f00c";
            color: #fff;
            background-color: #074e86;
            border: 0;
            display: inline-block;
            padding-left: 3px;
        }
        .select2-container--default .select2-results__option[aria-selected=true] {
            background-color: #fff;
        }
        .select2-container--default .select2-results__option--highlighted[aria-selected] {
            background-color: #eaeaeb;
            color: #272727;
        }
        .select2-container--default .select2-selection--multiple {
            margin-bottom: 10px;
        }
        .select2-container--default.select2-container--open.select2-container--below .select2-selection--multiple {
            border-radius: 4px;
        }
        .select2-container--default.select2-container--focus .select2-selection--multiple {
            border-color: #074e86;
            border-width: 2px;
        }
        .select2-container--default .select2-selection--multiple {
            border-width: 2px;
        }
        .select2-container--open .select2-dropdown--below {

            border-radius: 6px;
            box-shadow: 0 0 10px rgba(0,0,0,0.5);

        }
        .select2-selection .select2-selection--multiple:after {
            content: 'hhghgh';
        }
        /* select with icons badges single*/
        .select-icon .select2-selection__placeholder .badge {
            display: none;
        }
        .select-icon .placeholder {
            display: none;
        }
        .select-icon .select2-results__option:before,
        .select-icon .select2-results__option[aria-selected=true]:before {
            display: none !important;
            /* content: "" !important; */
        }
        .select-icon  .select2-search--dropdown {
            display: none;
        }
        /* .select2-selection__clear {
            display:none;
        } */
    </style>   

    <style>
        body{
            font-family: 'Jost', sans-serif;
            font-weight: 400;
        }
        :root{
            --primary: #074e86;
            --hov-primary: #FECC2D;
            --soft-primary: rgba(7,78,134,0.15);
        }

        #map{
            width: 100%;
            height: 250px;
        }
        #edit_map{
            width: 100%;
            height: 250px;
        }

        .pac-container { z-index: 100000; }
    </style>

    <noscript>
        <img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=&ev=PageView&noscript=1"/>
    </noscript>
    <!-- End Facebook Pixel Code -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500&amp;display=swap">
  </head>
  <body>
    <header class=" sticky-top  z-1020 bg-primary shadow-md" style="margin-top: 21px;">
      <div class="position-relative logo-bar-area z-1">
        <div class="container-fluid position-relative">
          <img src="https://mazingbusiness.com/public/assets/img/businessz.png" alt="Business Z" id="businessz" class="position-absolute z-1025" style="">
          <div class="d-flex align-items-center">
            <div class="pl-0 pr-3 d-flex align-items-center">
              <a class="d-block py-3 mr-5 ml-0 z-1035" href="#">
                <img class="logo" src="https://mazingbusiness.com/public/uploads/all/PH8lWzw1Qs3Z2QxgCOTYpdQe2DmP0GQHCSZaxXAk.png" alt="Mazing Business">
              </a>       
            </div>
          </div>
        </div>
      </div>
    </header>
   
    <section class="py-4">
      <style>
          .ajax-loader {
            visibility: hidden;
            background-color: rgba(255,255,255,0.7);
            position: absolute;
            z-index: +100 !important;
            width: 100%;
            height:100%;
          }

          .ajax-loader img {
            position: relative;
            top:50%;
            left:50%;
          }
          .custom-close {
              font-size: 1.8rem; /* Larger close button */
              color: #333; /* Cross color */
              background: transparent;
              border: none;
              cursor: pointer;
              padding: 5px;
              transition: color 0.3s ease;
          }
          
          .custom-close:hover {
              color: #ff0000; /* Change color on hover */
          }
          
          .modal-lg {
              max-width: 80%; /* Adjust modal width to 80% of screen */
          }
          
          .modal-header, .modal-body {
              padding: 20px; /* More padding for a cleaner layout */
          }
          
          .modal-body img {
              max-width: 100%; /* Ensure image is responsive */
              height: auto;
          }

          .modal-footer {
              justify-content: center; /* Center align footer buttons */
          }
      </style>
      <div class="ajax-loader" id="loaderDiv">
        <img src="https://mazingbusiness.com/public/assets/img/ajax-loader.gif" class="img-responsive">
      </div>
      <div class="container text-left">
        <div class="row">
          
          <div class="col-xl-8 mx-auto">
            <p id="upiSuccess" style="color: #2aa705; font-size: 30px; text-align: center;"></p>
            <p id="upiProgress" style="color: #e89507; font-size: 30px; text-align: center;"></p>
            <!-- Tabs Navigation -->
            <ul class="nav nav-tabs" id="paymentTab" role="tablist">
            @if($payment_for != 'payable_amount')
              <li class="nav-item" role="presentation">
                <a class="nav-link @if($payment_for == 'due_amount')active @endif" id="due-amount-tab" data-toggle="tab" href="#dueAmount" role="tab" aria-controls="dueAmount" @if($payment_for == 'due_amount') aria-selected="true" @else aria-selected="false" @endif @if($payment_for != 'due_amount')onclick="getAmount('{{ encrypt($billNumber) }}','due_amount')" @endif>Due Amount</a>
              </li>
              <li class="nav-item" role="presentation">
                <a class="nav-link @if($payment_for == 'overdue_amount')active @endif" id="overdue-amount-tab" data-toggle="tab" href="#overdueAmount" role="tab" aria-controls="overdueAmount" @if($payment_for == 'overdue_amount') aria-selected="true" @else aria-selected="false" @endif @if($payment_for != 'overdue_amount')onclick="getAmount('{{ encrypt($billNumber) }}','overdue_amount')" @endif>Overdue Amount</a>
              </li>
              <li class="nav-item" role="presentation">
                <a class="nav-link @if($payment_for == 'custom_amount')active @endif" id="custom-amount-tab" data-toggle="tab" href="#customAmount" role="tab" aria-controls="customAmount" @if($payment_for == 'custom_amount') aria-selected="true" @else aria-selected="false" @endif @if($payment_for != 'custom_amount')onclick="getAmount('{{ encrypt($billNumber) }}','custom_amount')" @endif>Custom Amount</a>
              </li>
              @endif
              <li class="nav-item" role="presentation">
                <a class="nav-link @if($payment_for == 'payable_amount')active @endif" id="payable-amount-tab" data-toggle="tab" href="#payable_amount" role="tab" aria-controls="payable_amount" @if($payment_for == 'payable_amount') aria-selected="true" @else aria-selected="false" @endif @if($payment_for != 'payable_amount')onclick="getAmount('{{ encrypt($billNumber) }}','payable_amount')" @endif>Payable Amount</a>
              </li>
            </ul>

            <!-- Tabs Content -->
            <div class="tab-content" id="paymentTabContent">
              @if($payment_for != 'payable_amount')
                <!-- Due Amount Tab -->
                <div class="tab-pane fade @if($payment_for == 'due_amount') show active @endif" id="dueAmount" role="tabpanel" aria-labelledby="due-amount-tab">
                  <div class="mb-4 bg-white p-4 rounded shadow-sm text-center" id="due_amount">
                    @if($payment_for == 'due_amount')
                      <h5 class="fw-600 mb-3 fs-17 pb-2">Due Amount</h5>
                      <table class="w-100 mt-n2">
                        <tbody>
                          <tr><td colspan="2" class="text-center"><strong>Payment Summary :</strong></td></tr>
                          <tr><td colspan="2" class="text-center"><strong>Payable Amount:</strong> ₹ {{$amount}}</td></tr>
                        </tbody>
                      </table>
                      <p>Pay your amount by scanning the QR CODE</p>
                      <img src="{{$qrCodeUrl}}" alt="UPI QR Code" class="img-fluid mt-n2">
                      <p class="text-muted" style="font-size: 14px;">(* This QR Code is valid for next 24 hrs.)</p>
                      <p>OR</p>
                      <p>Pay your amount by entering your @upi ID</p>
                      <div class="d-flex justify-content-center align-items-center">
                        <form method="POST" action="">
                          <div class="form-group mb-0">
                            @csrf
                            <input type="text" class="form-control mb-2" placeholder="@upiId" name="upi_id" id="upi_id" required="" style="width:239px;">
                            <input type="hidden" class="form-control" name="bill_number" id="bill_number" required="" value="{{ encrypt($billNumber) }}">
                            <input type="hidden" class="form-control" name="amount" id="amount" required="" value="{{ encrypt($amount) }}">
                            <input type="hidden" class="form-control" name="payment_for" id="payment_for" required="" value="{{$payment_for}}">
                          </div>
                          <!-- <button type="button" class="btn btn-primary mt-2">Verify and Pay</button> -->
                          <button type="button" class="btn btn-primary mt-2" id="btnVerifyAndPayForDueAmount" style="margin-bottom:10px;">Verify and Pay</button> <!-- Added mt-2 for margin-top -->
                        </form>
                      </div>
                    @endif
                  </div>
                </div>

                <!-- Overdue Amount Tab -->
                <div class="tab-pane fade @if($payment_for == 'overdue_amount') show active @endif" id="overdueAmount" role="tabpanel" aria-labelledby="overdue-amount-tab">
                  <div class="mb-4 bg-white p-4 rounded shadow-sm text-center" id="overdue_amount">
                    @if($payment_for == 'overdue_amount')
                      <h5 class="fw-600 mb-3 fs-17 pb-2">Overdue Amount</h5>
                      <table class="w-100 mt-n2">
                        <tbody>
                          <tr><td colspan="2" class="text-center"><strong>Payment Summary :</strong></td></tr>
                          <tr><td colspan="2" class="text-center"><strong>Payable Amount:</strong> ₹ {{$amount}}</td></tr>
                        </tbody>
                      </table>
                      <p>Pay your amount by scanning the QR CODE</p>
                      <img src="{{$qrCodeUrl}}" alt="UPI QR Code" class="img-fluid mt-n2">
                      <p class="text-muted" style="font-size: 14px;">(* This QR Code is valid for next 24 hrs.)</p>
                      <p>OR</p>
                      <p>Pay your amount by entering your @upi ID</p>
                      <div class="d-flex justify-content-center align-items-center">
                        <form method="POST" action="">
                          <div class="form-group mb-0">
                            @csrf
                            <input type="text" class="form-control mb-2" placeholder="@upiId" name="upi_id_od" id="upi_id_od" required="" style="width:239px;">
                            <input type="hidden" class="form-control" name="bill_number_od" id="bill_number_od" required="" value="{{ encrypt($billNumber) }}">
                            <input type="hidden" class="form-control" name="amount_od" id="amount_od" required="" value="{{ encrypt($amount) }}">
                            <input type="hidden" class="form-control" name="payment_for_od" id="payment_for_od" required="" value="{{$payment_for}}">
                          </div>
                          <!-- <button type="button" class="btn btn-primary mt-2">Verify and Pay</button> -->
                          <button type="button" class="btn btn-primary mt-2" id="btnVerifyAndPayForOverdueAmount" style="margin-bottom:10px;">Verify and Pay</button> <!-- Added mt-2 for margin-top -->
                        </form>
                      </div>
                    @endif
                  </div>
                </div>

                <!-- Custom Amount Tab -->
                <div class="tab-pane fade @if($payment_for == 'custom_amount') show active @endif" id="customAmount" role="tabpanel" aria-labelledby="custom-amount-tab">
                  <div class="mb-4 bg-white p-4 rounded shadow-sm text-center" id="custom_amount">
                    @if($payment_for == 'custom_amount')
                      <h5 class="fw-600 mb-3 fs-17 pb-2">Custom Amount</h5>
                      <table class="w-100">
                        <tbody>
                          <tr><td class="text-center"><strong>Due Amount:</strong> ₹ {{$dueAmount}}</td></tr>
                          <tr><td class="text-center"><strong>Overdue Amount:</strong> ₹ {{$overdueAmount}}</td></tr>
                        </tbody>
                      </table>
                      <p>Enter your amount and pay</p>
                      <div class="d-flex justify-content-center align-items-center">
                        <form method="POST" action="">
                          @csrf
                          <input type="text" class="form-control mb-2" placeholder="Enter your amount" name="amount_custom" id="amount_custom" required="" style="width:239px;">
                          <input type="hidden" class="form-control mb-2" name="billNumberCustom" id="billNumberCustom" value="{{ encrypt($billNumber) }}">
                          <input type="hidden" class="form-control mb-2" name="payment_for_custom" id="payment_for_custom" value="{{ $payment_for }}">
                          <button type="button" class="btn btn-primary mt-2" id="btnCustomPay" onclick="generateCustoPay()">Pay</button>
                        </form>
                      </div>
                    @endif
                  </div>
                </div>
              @endif
              <!-- Payable Amount Tab -->
              <div class="tab-pane fade @if($payment_for == 'payable_amount') show active @endif" id="payable_amount" role="tabpanel" aria-labelledby="payable-amount-tab">
                <div class="mb-4 bg-white p-4 rounded shadow-sm text-center" id="payable_amount">
                  @if($payment_for == 'payable_amount')
                    <table class="w-100 mt-n2">
                      <tbody>
                        <tr><td colspan="2" class="text-center"><strong>Payment Summary :</strong></td></tr>
                        <tr><td colspan="2" class="text-center"><strong>Payable Amount:</strong> ₹ {{$amount}}</td></tr>
                      </tbody>
                    </table>
                    <p>Pay your amount by scanning the QR CODE</p>
                    <img src="{{$qrCodeUrl}}" alt="UPI QR Code" class="img-fluid mt-n2">
                    <p class="text-muted" style="font-size: 14px;">(* This QR Code is valid for next 24 hrs.)</p>
                    <p>OR</p>
                    <p>Pay your amount by entering your @upi ID</p>
                    <div class="d-flex justify-content-center align-items-center">
                      <form method="POST" action="">
                        <div class="form-group mb-0">
                          @csrf
                          <input type="text" class="form-control mb-2" placeholder="@upiId" name="upi_id_od" id="upi_id_od" required="" style="width:239px;">
                          <input type="hidden" class="form-control" name="bill_number_od" id="bill_number_od" required="" value="{{ encrypt($billNumber) }}">
                          <input type="hidden" class="form-control" name="amount_od" id="amount_od" required="" value="{{ encrypt($amount) }}">
                          <input type="hidden" class="form-control" name="payment_for_od" id="payment_for_od" required="" value="{{$payment_for}}">
                        </div>
                        <!-- <button type="button" class="btn btn-primary mt-2">Verify and Pay</button> -->
                        <button type="button" class="btn btn-primary mt-2" id="btnVerifyAndPayForOverdueAmount" style="margin-bottom:10px;">Verify and Pay</button> <!-- Added mt-2 for margin-top -->
                      </form>
                    </div>
                  @endif
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- Optional JavaScript for Bootstrap Tabs -->
        <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
      </div>
    </section>
    <!-- FOOTER -->
    <footer class="pt-3 pb-7 pb-xl-3 bg-primary text-light">
      <div class="container-fluid">
        <div class="row align-items-center">
          <div class="col-lg-12">
            <div class="text-center text-md-center" current-verison="6.5.0">
              <p class="MsoNormal"><span style="font-size: 14pt; line-height: 107%;" times="" new="" roman",serif;mso-fareast-font-family:aptos;mso-fareast-theme-font:="" minor-latin;mso-ansi-language:en-in;mso-fareast-language:en-us;mso-bidi-language:="" ar-sa"="">Ace Tools Pvt. Ltd. © {{ date('Y')}}. All Rights Reserved.</span><br></p>
            </div>
          </div>   
        </div>
      </div>
    </footer>
    <script>
      $(document).ready(function() {
        // Check if the modal exists in the DOM
        if ($('#paymentModal').length) {
            $('#paymentModal').modal('show'); // Show the modal on page load
        }
        @if($merchantTranId != "")
          // Define merchantTranId from your backend or assign it dynamically
          var merchantTranId = '{{ $merchantTranId }}';
          // Call the function immediately on page load
          getQrPaymentSuccessStatus(merchantTranId);
          // Start polling every 5 seconds
          var intervalId = setInterval(function() {
              getQrPaymentSuccessStatus(merchantTranId, intervalId); // Pass intervalId to stop polling later
          }, 5000); // 5000 milliseconds = 5 seconds
        @endif
        $('#btnVerifyAndPayForDueAmount').click(function() {
            var upi_id = $('#upi_id').val(); // Get the UPI ID input value
            var bill_number = $('#bill_number').val(); // Get the bill number
            var amount = $('#amount').val(); // Get the bill number
            var payment_for = $('#payment_for').val(); // Get the bill number
            $('#upiError').empty(); // Clear any previous errors
            clearInterval(intervalId);
            if (upi_id != "") {
                $.ajax({
                    url: '{{ route("verifyAndPayFromPaymentPage") }}',
                    type: 'POST',
                    beforeSend: function() {
                        $('#loaderDiv').css("visibility", "visible");
                    },
                    data: { 
                        upi_id: upi_id, 
                        bill_number: bill_number,
                        amount: amount,
                        payment_for: payment_for,
                        _token: '{{ csrf_token() }}'
                    },
                    dataType: 'json',
                    success: function(response) {
                        console.log(response); 
                        if (response.status === 'Error') {
                            $('#upiError').append(response.message);
                        } else if (response.status === 'Success') {
                            // alert('Payment successful!');
                            $('#upiProgress').empty();
                            $('#upiSuccess').empty();
                            $('#upiProgress').append('<h1 class="h3 mb-3 fw-600">'+response.message+'</h1>');
                            if(response.merchantTranId != 0){
                              // Start polling the server every 5 seconds
                              var intervalId = setInterval(function() {
                                  getPaymentSuccessStatus(response.merchantTranId, intervalId); // Pass intervalId to stop polling
                              }, 5000); // 5000 milliseconds = 5 seconds 
                            }                  
                        } else {
                            $('#upiError').append('Unexpected response from server. Please try again.');
                        }
                    },
                    complete: function() {
                        $('#loaderDiv').css("visibility", "hidden");
                    },
                    error: function(xhr, status, error) {
                        console.error(xhr.responseText);
                        $('#upiError').append('An error occurred while processing your request. Please try again.');
                    }
                });
            } else {
                alert('Please enter your UPI ID.');
            }
        });

        $('#btnVerifyAndPayForOverdueAmount').click(function() {
            var upi_id = $('#upi_id_od').val(); // Get the UPI ID input value
            var bill_number = $('#bill_number_od').val(); // Get the bill number
            var amount = $('#amount_od').val(); // Get the bill number
            var payment_for = $('#payment_for_od').val(); // Get the bill number
            $('#upiError').empty(); // Clear any previous errors
            clearInterval(intervalId);
            if (upi_id != "") {
                $.ajax({
                    url: '{{ route("verifyAndPayFromPaymentPage") }}',
                    type: 'POST',
                    beforeSend: function() {
                        $('#loaderDiv').css("visibility", "visible");
                    },
                    data: { 
                        upi_id: upi_id, 
                        bill_number: bill_number,
                        amount: amount,
                        payment_for: payment_for,
                        _token: '{{ csrf_token() }}'
                    },
                    dataType: 'json',
                    success: function(response) {
                        console.log(response); 
                        if (response.status === 'Error') {
                            $('#upiError').append(response.message);
                        } else if (response.status === 'Success') {
                            // alert('Payment successful!');
                            $('#upiProgress').empty();
                            $('#upiSuccess').empty();
                            $('#upiProgress').append('<h1 class="h3 mb-3 fw-600">'+response.message+'</h1>');
                            if(response.merchantTranId != 0){
                              // Start polling the server every 5 seconds
                              var intervalId = setInterval(function() {
                                  getPaymentSuccessStatus(response.merchantTranId, intervalId); // Pass intervalId to stop polling
                              }, 5000); // 5000 milliseconds = 5 seconds 
                            }                  
                        } else {
                            $('#upiError').append('Unexpected response from server. Please try again.');
                        }
                    },
                    complete: function() {
                        $('#loaderDiv').css("visibility", "hidden");
                    },
                    error: function(xhr, status, error) {
                        console.error(xhr.responseText);
                        $('#upiError').append('An error occurred while processing your request. Please try again.');
                    }
                });
            } else {
                alert('Please enter your UPI ID.');
            }
        });

        // $('#btnCustomPay').click(function() {
        //     var amount_custom = $('#amount_custom').val(); // Get the UPI ID input value
        //     var bill_number = $('#billNumberCustom').val(); // Get the bill number
        //     var payment_for = $('#payment_for').val(); // Get the bill number
        //     $('#upiError').empty(); // Clear any previous errors
        //     // clearInterval(intervalId);
        //     if (amount_custom > 0) {
        //         $.ajax({
        //             url: '{{ route("generateQrCodeForCustomAmount") }}',
        //             type: 'POST',
        //             beforeSend: function() {
        //                 $('#loaderDiv').css("visibility", "visible");
        //             },
        //             data: { 
        //                 amount: amount_custom, 
        //                 billnumber: bill_number,
        //                 payment_for: payment_for,
        //                 _token: '{{ csrf_token() }}'
        //             },
        //             dataType: 'json',
        //             success: function(response) {
        //                 console.log(response); 
        //                 if (response.status === 'Error') {
        //                     $('#upiError').append(response.message);
        //                 } else if (response.status === 'Success') {
        //                   $('#'+payment_for).empty(); // Clear the div before appending new data
        //                   $('#'+payment_for).append(response.html); // Append the response data
        //                   if(response.merchantTranId != ""){
        //                     // clearInterval(intervalId);
        //                     // Start polling the server every 5 seconds
        //                     var intervalId = setInterval(function() {
        //                         getPaymentSuccessStatus(response.merchantTranId, intervalId); // Pass intervalId to stop polling
        //                     }, 5000); // 5000 milliseconds = 5 seconds
        //                   }                
        //                 } else {
        //                     $('#upiError').append('Unexpected response from server. Please try again.');
        //                 }
        //             },
        //             complete: function() {
        //                 $('#loaderDiv').css("visibility", "hidden");
        //             },
        //             error: function(xhr, status, error) {
        //                 console.error(xhr.responseText);
        //                 $('#upiError').append('An error occurred while processing your request. Please try again.');
        //             }
        //         });
        //     } else {
        //         alert('Please enter your amount greater than 0.00.');
        //     }
        // });
      });

      function generateCustoPay(){
        var amount_custom = $('#amount_custom').val(); // Get the UPI ID input value
        var bill_number = $('#billNumberCustom').val(); // Get the bill number
        var payment_for = $('#payment_for_custom').val(); // Get the bill number
        $('#upiError').empty(); // Clear any previous errors
        // clearInterval(intervalId);
        if (amount_custom > 0) {
            $.ajax({
                url: '{{ route("generateQrCodeForCustomAmount") }}',
                type: 'POST',
                beforeSend: function() {
                    $('#loaderDiv').css("visibility", "visible");
                },
                data: { 
                    amount: amount_custom, 
                    billnumber: bill_number,
                    payment_for: payment_for,
                    _token: '{{ csrf_token() }}'
                },
                dataType: 'json',
                success: function(response) {
                    console.log(response); 
                    if (response.status === 'Error') {
                        $('#upiError').append(response.message);
                    } else if (response.status === 'Success') {
                      $('#'+payment_for).empty(); // Clear the div before appending new data
                      $('#'+payment_for).append(response.html); // Append the response data
                      if(response.merchantTranId != ""){
                        // clearInterval(intervalId);
                        // Start polling the server every 5 seconds
                        var intervalId = setInterval(function() {
                            getPaymentSuccessStatus(response.merchantTranId, intervalId); // Pass intervalId to stop polling
                        }, 5000); // 5000 milliseconds = 5 seconds
                      }                
                    } else {
                        $('#upiError').append('Unexpected response from server. Please try again.');
                    }
                },
                complete: function() {
                    $('#loaderDiv').css("visibility", "hidden");
                },
                error: function(xhr, status, error) {
                    console.error(xhr.responseText);
                    $('#upiError').append('An error occurred while processing your request. Please try again.');
                }
            });
        } else {
            alert('Please enter your amount greater than 0.00.');
        }
      }

      function payCustomAmount(){
        var upi_id = $('#upi_id_custom').val(); // Get the UPI ID input value
        var bill_number = $('#bill_number_custom').val(); // Get the bill number
        var amount = $('#amount_custom').val(); // Get the bill number
        var payment_for = $('#payment_for_custom').val(); // Get the bill number
        $('#upiError').empty(); // Clear any previous errors
        // clearInterval(intervalId);
        if (upi_id != "") {
            $.ajax({
                url: '{{ route("verifyAndPayFromPaymentPage") }}',
                type: 'POST',
                beforeSend: function() {
                    $('#loaderDiv').css("visibility", "visible");
                },
                data: { 
                    upi_id: upi_id, 
                    bill_number: bill_number,
                    amount: amount,
                    payment_for: payment_for,
                    _token: '{{ csrf_token() }}'
                },
                dataType: 'json',
                success: function(response) {
                    console.log(response); 
                    if (response.status === 'Error') {
                        $('#upiError').append(response.message);
                    } else if (response.status === 'Success') {
                        // alert('Payment successful!');
                        $('#upiProgress').empty();
                        $('#upiSuccess').empty();
                        $('#upiProgress').append('<h1 class="h3 mb-3 fw-600">'+response.message+'</h1>');
                        if(response.merchantTranId != 0){
                          // Start polling the server every 5 seconds
                          var intervalId = setInterval(function() {
                              getPaymentSuccessStatus(response.merchantTranId, intervalId); // Pass intervalId to stop polling
                          }, 5000); // 5000 milliseconds = 5 seconds 
                        }                  
                    } else {
                        $('#upiError').append('Unexpected response from server. Please try again.');
                    }
                },
                complete: function() {
                    $('#loaderDiv').css("visibility", "hidden");
                },
                error: function(xhr, status, error) {
                    console.error(xhr.responseText);
                    $('#upiError').append('An error occurred while processing your request. Please try again.');
                }
            });
        } else {
            alert('Please enter your UPI ID.');
        }
      }



      function getQrPaymentSuccessStatus(merchantTranId,intervalId){
        $.ajax({
            url: '{{ route("checkPaymentStatus") }}', // Replace with your actual payment status endpoint
            type: 'POST',
            data: { 
              merchantTranId: merchantTranId,
              _token: '{{ csrf_token() }}'
            },
            dataType: 'json',
            success: function(response) {
                console.log('Checking payment status:', response);                      
                // Check if payment is successful (adjust this logic based on the actual response)
                if (response.status === 'Success') {
                    $('#upiProgress').empty();
                    $('#upiSuccess').empty();
                    $('#upiSuccess').append('<i class="la la-check-circle la-3x text-success mb-3"></i><h1 class="h3 mb-3 fw-600">Payment Success!</h1>');
                    // Stop the polling by clearing the interval
                    clearInterval(intervalId);
                    $('#divPayment').hide();
                }
            },
            error: function(xhr, status, error) {
                console.error(xhr.responseText);
            }
        });
      }
      
      function getPaymentSuccessStatus(merchantTranId,intervalId){
        $.ajax({
            url: '{{ route("checkPaymentStatus") }}', // Replace with your actual payment status endpoint
            type: 'POST',
            data: { 
              merchantTranId: merchantTranId,
              _token: '{{ csrf_token() }}'
            },
            dataType: 'json',
            success: function(response) {
                console.log('Checking payment status:', response);                      
                // Check if payment is successful (adjust this logic based on the actual response)
                if (response.status === 'Success') {
                    $('#upiProgress').empty();
                    $('#upiSuccess').empty();
                    $('#upiSuccess').append('<i class="la la-check-circle la-3x text-success mb-3"></i><h1 class="h3 mb-3 fw-600">Payment Success!</h1>');
                    // Stop the polling by clearing the interval
                    clearInterval(intervalId);
                    $('#divPayment').hide();
                }
                if (response.status === 'FAILURE') {
                    $('#upiProgress').empty();
                    $('#upiSuccess').empty();
                    $('#upiProgress').append('<i class="fa fa-exclamation-triangle fa-3x text-warning mb-3" aria-hidden="true"></i><h1 class="h3 mb-3 fw-600" style="color: #e89507; font-size: 30px; text-align: center;">Payment Failure!</h1>');
                    // Stop the polling by clearing the interval
                    clearInterval(intervalId);
                    $('#divPayment').hide();
                }
            },
            error: function(xhr, status, error) {
                console.error(xhr.responseText);
            }
        });
      }

      function getAmount(billnumber,payment_for){
        $('#upiError').empty(); // Clear any previous errors
        $.ajax({
            url: '{{ route("getAmount") }}', // Replace with your actual payment status endpoint
            type: 'POST',
            data: { 
              billnumber: billnumber,
              payment_for: payment_for,
              _token: '{{ csrf_token() }}'
            },
            dataType: 'json',            
            beforeSend: function() {
                $('#loaderDiv').css("visibility", "visible");
            },
            success: function(response) {
                console.log('Checking payment status:', response);
                $('#'+payment_for).empty(); // Clear the div before appending new data
                $('#'+payment_for).append(response.html); // Append the response data
                if(response.merchantTranId != ""){
                  // clearInterval(intervalId);
                  // Start polling the server every 5 seconds
                  var intervalId = setInterval(function() {
                      getPaymentSuccessStatus(response.merchantTranId, intervalId); // Pass intervalId to stop polling
                  }, 5000); // 5000 milliseconds = 5 seconds
                }
            },
            complete: function() {
                $('#loaderDiv').css("visibility", "hidden");
            },
            error: function(xhr, status, error) {
                console.error(xhr.responseText);
            }
        });
      }
    </script>
  </body>
</html>